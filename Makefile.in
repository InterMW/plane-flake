PROGNAME=dump1090
prefix = @prefix@
exec_prefix = @exec_prefix@
bindir = @bindir@
LIBS=-lpthread -lm -lrt -lrabbitmq
LIBS_RTL=`pkg-config --libs librtlsdr libusb-1.0`

all: dump1090 

dump1090.o: CFLAGS += `pkg-config --cflags librtlsdr libusb-1.0`

%.o: %.c *.h
	$(CC) $(CPPFLAGS) $(CFLAGS) $(EXTRACFLAGS) $(LIBS) -c $< -o $@ 

dump1090: dump1090.o anet.o interactive.o rabbitUtils.o mode_ac.o mode_s.o net_io.o crc.o demod_2400.o stats.o cpr.o icao_filter.o track.o util.o convert.o $(COMPAT)
	$(CC) -g -o $@ $^ $(LIBS) $(LIBS_RTL) $(LDFLAGS)

clean:
	rm -f *.o compat/clock_gettime/*.o compat/clock_nanosleep/*.o dump1090 view1090 faup1090 cprtests crctests

install: dump1090
	install -d $(bindir)
	install -t $(bindir) dump1090
